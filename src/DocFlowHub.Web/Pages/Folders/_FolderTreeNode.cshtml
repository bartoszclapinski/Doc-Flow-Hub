@model DocFlowHub.Core.Models.Projects.Dto.FolderDto

<div class="folder-tree-node @(Model.Children?.Any() == true ? "" : "no-children")" data-id="@Model.Id">
    <div class="folder-item">
        @if (Model.Children?.Any() == true)
        {
            <div class="folder-toggle">
                <i class="bi bi-chevron-down"></i>
            </div>
        }
        else
        {
            <div class="folder-toggle" style="visibility: hidden;">
                <i class="bi bi-chevron-right"></i>
            </div>
        }
        
        <div class="folder-icon-img">
            <i class="bi bi-folder-fill"></i>
        </div>
        
        <div class="folder-info">
            <div class="folder-name">@Model.Name</div>
            <div class="folder-meta">
                <span class="tree-meta-item">@Model.DocumentCount docs</span>
                <span class="tree-meta-separator">•</span>
                <span class="tree-meta-item">@(Model.Children?.Count() ?? 0) sub</span>
                <span class="tree-meta-separator">•</span>
                <span class="tree-meta-item">@Model.CreatedAt.ToString("MMM dd, yyyy")</span>
            </div>
        </div>
        
        <div class="folder-actions">
            <a asp-page="/Folders/Details" asp-route-id="@Model.Id" class="folder-action-btn" title="View Details">
                <i class="bi bi-eye"></i>
            </a>
            <a asp-page="/Folders/Edit" asp-route-id="@Model.Id" class="folder-action-btn" title="Edit">
                <i class="bi bi-pencil"></i>
            </a>
            <a asp-page="/Folders/Create" asp-route-projectId="@Model.ProjectId" asp-route-parentFolderId="@Model.Id" 
               class="folder-action-btn" title="Create Subfolder">
                <i class="bi bi-folder-plus"></i>
            </a>
            <div class="dropdown">
                <button class="folder-action-btn dropdown-toggle" type="button" 
                        data-bs-toggle="dropdown" aria-expanded="false" title="More actions">
                    <i class="bi bi-three-dots"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end modern-dropdown">
                    @if (Model.IsArchived)
                    {
                        <li>
                            <form method="post" asp-page-handler="Restore" style="display: inline; width: 100%;">
                                <input type="hidden" name="id" value="@Model.Id" />
                                <button type="submit" class="dropdown-item">
                                    <i class="bi bi-arrow-clockwise"></i>Restore Folder
                                </button>
                            </form>
                        </li>
                    }
                    else
                    {
                        <li>
                            <form method="post" asp-page-handler="Archive" style="display: inline; width: 100%;">
                                <input type="hidden" name="id" value="@Model.Id" />
                                <button type="submit" class="dropdown-item">
                                    <i class="bi bi-archive"></i>Archive Folder
                                </button>
                            </form>
                        </li>
                    }
                    <li><hr class="dropdown-divider"></li>
                    <li>
                        <button type="button" class="dropdown-item text-danger btn-delete-folder" 
                                data-folder-id="@Model.Id" data-folder-name="@Model.Name">
                            <i class="bi bi-trash"></i>Delete Folder
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    @if (Model.Children?.Any() == true)
    {
        <div class="folder-children">
            @foreach (var child in Model.Children)
            {
                <partial name="_FolderTreeNode" model="child" />
            }
        </div>
    }
</div>
